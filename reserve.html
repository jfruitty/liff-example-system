<!DOCTYPE html>
<html>
<head>
  <script src="https://static.line-scdn.net/liff/edge/versions/2.13.0/sdk.js"></script>
  <link rel="stylesheet" href="styles.css">
  
  <script>
    
  
  google.script.run
    .withSuccessHandler(updateSelectOptions)
    .getIdsWithAvailableStatus();


    function updateSelectOptions(ids) {

      var select = document.getElementById('selectId');
      ids.forEach(function(id) {
        var option = document.createElement('option');
        option.value = id;
        option.text = id;
        select.appendChild(option);
      });
    }
    
    document.getElementById('reserveButton').addEventListener('click', function() {
      var selectedId = document.getElementById('selectId').value;
      var userid = <?=  userid ?> ;
      var displayname = <?=  displayname ?> ;
      google.script.run.reserveId(selectedId,userid,displayname);
      alert('รับงานสำเร็จ');

      // Get a reference to the select element
      var selectElement = document.getElementById("selectId");

      // Remove all option elements
      while (selectElement.options.length > 0) {
        selectElement.remove(0);
      }

      google.script.run.withSuccessHandler(updateSelectOptions).getIdsWithAvailableStatus();
    });
  </script>

</head>
<body>
  <h1>ระบบรับงานช่าง</h1>
  <label for="selectId">เลือก Job ID งานที่ต้องการรับ:</label>
  <select id="selectId"></select>
  <button id="reserveButton">รับงาน</button>
  
 
</body>
</html>

